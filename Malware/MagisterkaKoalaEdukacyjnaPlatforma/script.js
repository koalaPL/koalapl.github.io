let lists = document.getElementsByClassName("dragObj");
let rightBox = document.getElementById("dragRightBox");
let leftBox = document.getElementById("dragLeftBox");
let centerBox = document.getElementById("dragCentralBox");

const resident = [
  "Trojan",
  "Ransomware",
  "Wirus płyty głównej",
  "Rootkit",
  "Backdoor",
  "Wabbit",
];
const noResident = [
  "SQL/URL injection",
  "Adware",
  "Stealware",
  "Keylogger",
  "Dialer",
  "Cryptomining",
  "Hijacker Browser Helper Object",
  "Wirus Dyskowy klastrowy",
  "Wirus plikowy",
  "Wirus Makro",
  "Wirus telefonu komórkowego",
  "Wirus typu robak",
  "Exploit",
  "Spam",
];

let blocksContent = [];
blocksContent = resident.concat(noResident);
generateBlocks();
function generateBlocks() {
  shuffleArray(blocksContent);
  for (let i = 0; i < blocksContent.length; i++) {
    let el = document.createElement("div");
    el.innerHTML =
      '<div class="dragObj" draggable="true" name="' +
      blocksContent[i] +
      '">' +
      blocksContent[i] +
      "</div>";
    centerBox.appendChild(el);
  }
}
function CheckDraggable() {
  for (let list of lists) {
    list.removeEventListener("dragstart", dragStart);
  }
  for (let child of leftBox.children) {
    for (let i = 0; i < resident.length; i++) {
      if (child.getAttribute("name") == resident[i]) {
        child.classList.remove("badListElement");
        child.classList.add("goodListElement");
        break;
      } else {
        child.classList.remove("goodListElement");
        child.classList.add("badListElement");
      }
    }
  }
  for (let child of rightBox.children) {
    for (let i = 0; i < noResident.length; i++) {
      if (child.getAttribute("name") == noResident[i]) {
        child.classList.remove("badListElement");
        child.classList.add("goodListElement");

        break;
      } else {
        child.classList.remove("goodListElement");
        child.classList.add("badListElement");
      }
    }
  }
}
function shuffleArray(arr) {
  arr.sort(() => Math.random() - 0.5);
}
///Draggable functions ///
// Add event listener for dragstart on parent element
for (let list of lists) {
  list.addEventListener("dragstart", dragStart);
}
// Prevent default behavior on dragover event
centerBox.addEventListener("dragover", function (e) {
  e.preventDefault();
});

// Handle drop event for centerBox
centerBox.addEventListener("drop", function (e) {
  let selected = document.getElementById("selected");
  centerBox.appendChild(selected);
  selected.removeAttribute("id");
});

// Prevent default behavior on dragover event
rightBox.addEventListener("dragover", function (e) {
  e.preventDefault();
});

// Handle drop event for rightBox
rightBox.addEventListener("drop", function (e) {
  let selected = document.getElementById("selected");
  rightBox.appendChild(selected);
  selected.removeAttribute("id");
});

// Prevent default behavior on dragover event
leftBox.addEventListener("dragover", function (e) {
  e.preventDefault();
});

// Handle drop event for leftBox
leftBox.addEventListener("drop", function (e) {
  let selected = document.getElementById("selected");
  leftBox.appendChild(selected);
  selected.removeAttribute("id");
});

// Drag start event handler
function dragStart(e) {
  let selected = e.target;
  selected.setAttribute("id", "selected");

  // Add event listener for dragend on selected element
  selected.addEventListener("dragend", function () {
    selected.removeAttribute("id");
  });
}

// slide elements

let pagesTest = new Array();

let dragBox = document.querySelector(".draggableElement");

generateQuests();
function generateQuests() {
  let quizBox = document.querySelector("#quizBox");
  let questHTML = ` <div class="Quest">
  <span class="question">Pytanie1</span>
   <span class="answer"><span>A.</span><input type="radio" name="test" id="test1" /><label for="test1">1</label></span>
   <span class="answer"><span>B.</span><input type="radio" name="test" id="test2" /><label for="test2">2</label></span>
   <span class="answer"><span>C.</span><input type="radio" name="test" id="test3" /><label for="test3">3</label></span>
   <span class="answer"><span>D.</span><input type="radio" name="test" id="test4" /><label for="test4">4</label></span></div>`;
  let questHTML2 = ` <div class="Quest">
   <span class="question">Pytanie2</span>
    <span class="answer"><span>A.</span><input type="radio" name="test" id="test1" /><label for="test1">1</label></span>
    <span class="answer"><span>B.</span><input type="radio" name="test" id="test2" /><label for="test2">2</label></span>
    <span class="answer"><span>C.</span><input type="radio" name="test" id="test3" /><label for="test3">3</label></span>
    <span class="answer"><span>D.</span><input type="radio" name="test" id="test4" /><label for="test4">4</label></span></div>`;
  questHTML += questHTML2;
  quizBox.innerHTML = questHTML;
  let allQuest = document.querySelectorAll(".Quest");
  for (let i = 0; i < allQuest.length; i++) {
    pagesTest.push(allQuest[i]);
  }
  pagesTest.push(dragBox);
  // shuffleArray(pagesTest);
}

let pageTestIndex = 0;
changePageTest();
function next() {
  if (pageTestIndex != pagesTest.length - 1) {
    pageTestIndex++;
    changePageTest();
  }
}
function previous() {
  if (pageTestIndex != 0) {
    pageTestIndex--;
    changePageTest();
  }
}
function changePageTest() {
  for (let i = 0; i < pagesTest.length; i++) {
    if (i === pageTestIndex) {
      pagesTest[pageTestIndex].classList.remove("hiddenElement");
    } else {
      pagesTest[i].classList.add("hiddenElement");
    }
  }
  if (pagesTest[pageTestIndex] === dragBox) {
    quizBox.classList.add("hiddenElement");
  } else {
    quizBox.classList.remove("hiddenElement");
  }
}
